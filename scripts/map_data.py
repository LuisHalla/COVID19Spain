from libs import *

postal = list(['03', '02', '04', '05', '08',
               '06', '48', '09', '15', '11',
               '10', '51', '14', '13', '12',
               '16', '35', '17', '18', '19',
               '21', '22', '23', '25', '24',
               '26', '27', '28', '29', '52',
               '30', 'NC', '33', '32', '34',
               '07', '36', '39', '37', '41',
               '40', '42', '20', '43', '44',
               '38', '45', '46', '47', '01',
               '50', '49'])

population = list(['1881762', '386464', '731792', '158421', '5714730',
            '669943', '1154334', '356055', '1120134', '1245960',
            '389558', '83517', '776789', '492591', '587064',
            '195516', '1128539', '786596', '921338', '265588',
            '525835', '224264', '627190', '439727', '451706',
            '319796', '326013', '6751251', '1695651', '86261',
            '1518486', '1', '1011792', '305223', '159123',
            '1173008', '944275', '584507', '327338', '1947852',
            '153663', '88747', '726033', '822309', '134545',
            '1044405', '709403', '2589312', '519361', '333626',
            '967452', '168725'])



df = pd.read_csv("../data/covid_clean.csv")

cum = df.groupby(['code']).sum()

cum['postal'] = postal
cum['population'] = list(map(int, population))
cum['map'] = cum.positive / cum.population * 1e5


# Export data
cum.to_csv('../data/cum.csv')
